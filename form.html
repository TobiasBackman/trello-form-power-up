<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Form</title>
  <style>
    body { font-family: Arial, sans-serif; }
    .form-container { padding: 10px; }
  </style>
</head>
<body>
  <div class="form-container">
    <h3>Custom Form</h3>
    <label for="question-1">Question 1:</label>
    <input type="text" id="question-1">
    <button id="save-button">Save</button>
  </div>

  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <script>
    var t = window.TrelloPowerUp.iframe();

    // Initialize the Power-Up and inject into Trello
    window.TrelloPowerUp.initialize({
      'card-buttons': function(t, options) {
        return [{
          text: 'Add Form',
          callback: function(t) {
            return t.popup({
              title: 'Custom Form',
              url: 'https://tobiasbackman.github.io/trello-form-power-up/form.html', // Ensure this matches your GitHub Pages URL
              height: 300
            });
          }
        }];
      },
      'card-back-section': function(t, options) {
        return {
          title: 'Custom Form',
          content: {
            type: 'iframe',
            url: t.signUrl('https://tobiasbackman.github.io/trello-form-power-up/form.html'), // Ensure this matches your GitHub Pages URL
            height: 250
          }
        };
      }
    });

    // Form saving logic
    document.getElementById('save-button').addEventListener('click', function() {
      var answer = document.getElementById('question-1').value;
      t.set('card', 'shared', 'formData', { question1: answer }).then(function() {
        t.closePopup();
      });
    });

    // Load previously saved form data, if available
    t.render(function() {
      t.get('card', 'shared', 'formData').then(function(data) {
        if (data && data.question1) {
          document.getElementById('question-1').value = data.question1;
        }
      });
    });
  </script>
</body>
</html>
